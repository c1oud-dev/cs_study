<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{ page.title }}</title>
    <style>
    /* ========== Base ========== */
    body {
      margin: 0;
      font-family: sans-serif;
      line-height: 1.6;
      background: #f9f9f9;
      color: #333;
    }
    a { text-decoration: none; color: inherit; }

    /* Header */
    header {
      padding: 1rem 1rem;
      background: #fff;
      border-bottom: 1px solid #ddd;
    }
    .logo { font-size: 1.5rem; font-weight: bold; color: #0366d6; }

    /* ========== Container & Main ========== */
    /* 기본은 일반 블록 레이아웃(홈 등) */
    .container {
      display: block;                 /* ← flex 제거 */
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 1rem;
    }
    .container > main {
      width: 100%;
      max-width: 1100px;
      box-sizing: border-box;
      padding: 0;
      margin: 0 auto;                 /* 기본은 가운데 정렬 */
    }

    /* 사이드바 있는 페이지 전용 그리드 */
    .has-sidebar .container {
      display: grid !important;       /* 충돌 방지용 */
      grid-template-columns: 260px 1fr;
      gap: 2rem;
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 1rem;
    }
    .has-sidebar .container > main {
      grid-column: 2;
      max-width: none;                /* 고정폭 해제 → 칼럼 가득 */
      width: 100%;
      margin: 0;                      /* 가운데 정렬 해제 */
      padding-left: .25rem;
      padding-right: .25rem;
    }

    /* ========== Sidebar ========== */
    .sidebar {
      grid-column: 1;
      position: sticky;
      top: 56px;                      /* 헤더 높이에 맞게 조절 가능 */
      align-self: start;
      background: #f7f7f7;
      border-right: 1px solid #e5e5e5;
      padding: 1rem;
      border-radius: 8px;
      height: auto;                   /* 내부 스크롤 제거 → 페이지 하나만 스크롤 */
      overflow: visible;
    }
    .sidebar ul { list-style: none; padding: 0; margin: 0; }
    .sidebar li { margin-bottom: 0.5rem; }
    .sidebar a { display: block; padding: 0.35rem 0.4rem 0.35rem 0.6rem; color: #2b6cb0; border-radius: 6px; }
    .sidebar a:hover { background: #e9eef9; }
    .sidebar a.active {
      background: #e2e8ff;
      color: #1e40af;
      font-weight: 700;
      border-left: 3px solid #6a5af9;
    }
    .sidebar summary {
      font-weight: 700;
      cursor: pointer;
      padding: 0.4rem 0;
      color: #333;
      list-style: none;
    }
    .sidebar details > ul { list-style: none; margin: 0.25rem 0 0.5rem 0; padding: 0; }
    .sidebar nav { margin-top: 0.5rem; }
    .sidebar .nav-search { margin-bottom: 0.75rem; }
    .sidebar .nav-search input {
      width: 100%;
      height: 36px;
      padding: 0.4rem 0.6rem;
      border: 1px solid #d0d0d0;
      border-radius: 6px;
      font-size: 0.95rem;
      background: #fff;
    }

    /* ========== Accordion (공통) ========== */
    details {
      border: 1px solid #ddd;
      border-radius: 6px;
      margin-bottom: 1.5rem;
      background: #fff;
    }
    summary {
      cursor: pointer;
      padding: 0.75rem 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 1.25rem;
      list-style: none;
      outline: none;
    }
    .indicator { font-size: 0.875rem; color: #0366d6; }
    .accordion-content { padding: 0 1rem 1rem; }
    .accordion-content li { font-size: 0.9rem; line-height: 1.6; }
    .accordion-title { font-weight: 700; color: #0366d6; }
    summary:hover .accordion-title { color: #0255a5; }

    /* ========== Nested details (들여쓰기) ========== */
    .nested-details {
      margin-left: 20px;
      border-left: 3px solid #ddd;
      padding-left: 10px;
      margin-top: 0.75rem;
    }

    /* ========== Home 전용(있어도 무해) ========== */
    .hero { padding: 3rem 2rem; background: #fff; text-align: center; }
    .hero h1 { font-size: 2.5rem; margin-bottom: 1rem; }
    .hero p { font-size: 1.125rem; color: #555; margin-bottom: 1.5rem; }
    .search-input {
      padding: 0.75rem 1rem;
      width: 300px;
      max-width: 100%;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
    }

    /* ========== Responsive ========== */
    /* 1024px 이하: 사이드바 위/본문 아래 (단일 컬럼) */
    @media screen and (max-width: 1024px) {
      .has-sidebar .container {
        display: block !important;
        padding: 0 0.75rem;
      }
      .sidebar {
        position: static;
        height: auto;
        margin: 0.75rem 0 0;
        border-right: none;
      }
      .container > main {
        max-width: 1100px;
        margin: 0 auto;
      }
    }

    /* 600px 이하: 아코디언/검색 등 자잘한 보정 */
    @media screen and (max-width: 600px) {
      .hero { padding: 2rem 1rem; }
      .search-input { width: 100%; }
    }
  </style>

</head>
  
<body class="{% if page.sidebar == false %}no-sidebar{% else %}has-sidebar{% endif %}">
  <header>
    <a href="/cs_study/home.html" class="logo">CS 정리</a>
  </header>

  <div class="container">
    <main>
      {{ content }}
    </main>

    {%- unless page.sidebar == false -%}
    <aside class="sidebar">
      {% include sidebar.html %}
    </aside>
    {%- endunless -%}
  </div>

  <script>
    // Accordion toggle indicator update
    document.querySelectorAll('details').forEach(detail => {
      const indicator = detail.querySelector('.indicator');
      detail.addEventListener('toggle', () => {
        indicator.textContent = detail.open ? '접기' : '펼치기';
      });
    });
    // Home category search filter
    const searchInput = document.querySelector('.search-input');
    if (searchInput) {
      searchInput.addEventListener('input', e => {
        const filter = e.target.value.toLowerCase();
        document.querySelectorAll('.category-card').forEach(card => {
          const text = card.textContent.toLowerCase();
          card.style.display = text.includes(filter) ? 'flex' : 'none';
        });
      });
    }

    // --- Sidebar: 현재 페이지 링크 하이라이트 추가 ---
  (function() {
    const here = location.pathname.replace(/\/+$/, ""); // 끝 '/' 제거
    document.querySelectorAll(".sidebar a").forEach(a => {
      const href = a.getAttribute("href");
      if (!href) return;
      const clean = href.replace(/\/+$/, "");
      // 정확히 같거나, 현재 경로가 해당 링크로 끝나는 경우 활성화
      if (here === clean || (clean !== "/" && here.endsWith(clean))) {
        a.classList.add("active");
      }
    });
  })();

  // --- Sidebar: 검색 필터 추가 ---
  (function() {
    const input = document.getElementById("nav-filter");
    if (!input) return;

    input.addEventListener("input", (e) => {
      const q = e.target.value.trim().toLowerCase();

      // 링크 텍스트 기준 필터
      const links = document.querySelectorAll(".sidebar nav a");
      links.forEach(a => {
        const show = a.textContent.toLowerCase().includes(q);
        a.style.display = show ? "block" : "none";
      });

      // details 그룹: 내부에 보이는 링크가 있으면 펼치고, 없으면 숨김
      document.querySelectorAll(".sidebar nav details").forEach(d => {
        const anyVisible = Array.from(d.querySelectorAll("a")).some(a => a.style.display !== "none");
        d.open = anyVisible || q !== "";
        d.style.display = anyVisible || q === "" ? "block" : "none";
      });
    });
  })();
    
  </script>
</body>
</html>
