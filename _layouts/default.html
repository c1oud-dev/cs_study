<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{ page.title }}</title>
  <style>
    /* Base Styles */
    body {
      margin: 0;
      font-family: sans-serif;
      line-height: 1.6;
      background: #f9f9f9;
      color: #333;
    }
    a { text-decoration: none; color: inherit; }

    /* Header */
    header {
      padding: 1rem 1rem;
      background: #fff;
      border-bottom: 1px solid #ddd;
    }
    .logo { font-size: 1.5rem; font-weight: bold; color: #0366d6; }

    /* Layout Container */
    .container {
      display: flex;
      justify-content: flex-start;  /* 왼쪽 정렬 */
      gap: 2rem;                   /* 콘텐츠와 사이드바 사이 간격 */
      max-width: 1280px;           /* 페이지 전체 최대 너비 */
      margin: 0 auto;              /* 화면 중앙 배치 */
      padding: 0 0.75rem;            /* 화면 가장자리 여백 */
      flex-wrap: wrap;
    }
    .container > main {
      width: 100%;
      max-width: 1100px;            /* 본문 최대 너비 */
      padding: 0 0.75rem;             /* 본문 좌우 여백 */
      box-sizing: border-box;
      margin: 0;              /* 본문 중앙 정렬 */
    }

/* Sidebar (left sticky on desktop) */
.has-sidebar .container {
  /* 데스크톱: 좌측 260px, 우측 본문 영역 1fr 그리드 */
  display: grid;
  grid-template-columns: 260px 1fr;
  gap: 2rem;
  max-width: 1280px;
  margin: 0 auto;
  padding: 0 1rem;
}

.sidebar {
  position: sticky;      /* 스크롤해도 상단 기준으로 고정 */
  top: 72px;             /* 헤더 높이 감안 (필요시 조절) */
  align-self: start;
  height: calc(100vh - 72px);
  overflow: auto;
  background: #f7f7f7;
  border-right: 1px solid #e5e5e5;
  padding: 1rem;
  border-radius: 8px;
}

/* 사이드바 내 네비게이션 */
.sidebar nav { margin-top: 0.5rem; }
.sidebar .nav-search {
  margin-bottom: 0.75rem;
}
.sidebar .nav-search input {
  width: 100%;
  height: 36px;
  padding: 0.4rem 0.6rem;
  border: 1px solid #d0d0d0;
  border-radius: 6px;
  font-size: 0.95rem;
  background: #fff;
}

.sidebar summary {
  font-weight: 700;
  cursor: pointer;
  padding: 0.4rem 0;
  color: #333;
  list-style: none;
}
.sidebar details > ul {
  list-style: none; margin: 0.25rem 0 0.5rem 0; padding: 0;
}

.sidebar a {
  display: block;
  padding: 0.35rem 0.4rem 0.35rem 0.6rem;
  color: #2b6cb0;                /* 링크 컬러 */
  border-radius: 6px;
  text-decoration: none;
  font-size: 0.95rem;
}
.sidebar a:hover {
  background: #e9eef9;
}
.sidebar a.active {
  background: #e2e8ff;           /* 현재 위치 하이라이트 */
  color: #1e40af;
  font-weight: 700;
  border-left: 3px solid #6a5af9;
}

/* 본문 컨테이너/메인 영역 보정 */
.container > main {
  max-width: 1100px;
  width: 100%;
  padding: 0;  /* 그리드 기준으로 좌우 여백은 container에서 */
  box-sizing: border-box;
}

/* Responsive: 태블릿/모바일은 단일 컬럼(사이드바 위, 본문 아래) */
@media screen and (max-width: 1024px) {
  .has-sidebar .container {
    display: block;
    padding: 0 0.75rem;
  }
  .sidebar {
    position: static;
    height: auto;
    margin: 0.75rem 0 0;
    border-right: none;
  }
}
    /* Accordion */
    details {
      border: 1px solid #ddd;
      border-radius: 6px;
      margin-bottom: 1.5rem;
      background: #fff;
    }
    summary {
      cursor: pointer;
      padding: 0.75rem 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 1.25rem;
      list-style: none;
      outline: none;
    }
    .indicator { font-size: 0.875rem; color: #0366d6; }
    .accordion-content { padding: 0 1rem 1rem; }
    .accordion-content li { font-size: 0.9rem; line-height: 1.6; }
    .accordion-title {
      font-weight: 700;      /* 굵게 */
      color: #0366d6;        /* 강조 색상 */
    }
    summary:hover .accordion-title {
      color: #0255a5;        /* 호버 시 조금 진하게 (선택) */
    }

    /* Hero & Category Styles (for home) */
    .hero { padding: 3rem 2rem; background: #fff; text-align: center; }
    .hero h1 { font-size: 2.5rem; margin-bottom: 1rem; }
    .hero p { font-size: 1.125rem; color: #555; margin-bottom: 1.5rem; }
    .search-input {
      padding: 0.75rem 1rem;
      width: 300px;
      max-width: 100%;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
    }
    .category-section { max-width: 1000px; margin: 2rem auto; padding: 0 2rem; }
    .category-section h2 { font-size: 1.75rem; margin-bottom: 1rem; text-align: center; }
    .category-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 1rem; justify-items: center; }
    .category-card {
      width: 100px;
      height: 100px;
      border-radius: 4px;
      background: #0366d6;
      display: flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      color: #fff;
      font-size: 0.9rem;
      text-align: center;
      padding: 1rem;
      transition: background 0.2s;
    }
    .category-card:hover { background: #0255a5; }

    /* Nested details (들여쓰기 적용) */
    .nested-details {
      margin-left: 20px;
      border-left: 3px solid #ddd;
      padding-left: 10px;
      margin-top: 0.75rem;
    }

    /* Responsive */
   @media screen and (max-width: 1200px) {
     .has-sidebar .container { padding-right: 0; }   /* 오른쪽 예약 해제 */
     .container { flex-direction: column; }          /* 메인 위, 사이드바 아래 */
     .sidebar {
       position: static; width: 100%; height: auto;
       box-shadow: none; margin-top: 1rem;
     }
   }
    @media screen and (max-width: 600px) {
      .hero { padding: 2rem 1rem; }
      .search-input { width: 100%; }
      .category-grid { grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); }
      .category-card { width: 80px; height: 80px; font-size: 0.8rem; border-radius: 4px; }
    }
  </style>
</head>
<body class="{% unless page.sidebar == false %}has-sidebar{% endunless %}">
  <header>
    <a href="/cs_study/home.html" class="logo">CS 정리</a>
  </header>

  <div class="container">
    <main>
      {{ content }}
    </main>

    {%- unless page.sidebar == false -%}
    <aside class="sidebar">
      {% include sidebar.html %}
    </aside>
    {%- endunless -%}
  </div>

  <script>
    // Accordion toggle indicator update
    document.querySelectorAll('details').forEach(detail => {
      const indicator = detail.querySelector('.indicator');
      detail.addEventListener('toggle', () => {
        indicator.textContent = detail.open ? '접기' : '펼치기';
      });
    });
    // Home category search filter
    const searchInput = document.querySelector('.search-input');
    if (searchInput) {
      searchInput.addEventListener('input', e => {
        const filter = e.target.value.toLowerCase();
        document.querySelectorAll('.category-card').forEach(card => {
          const text = card.textContent.toLowerCase();
          card.style.display = text.includes(filter) ? 'flex' : 'none';
        });
      });
    }

    // --- Sidebar: 현재 페이지 링크 하이라이트 추가 ---
  (function() {
    const here = location.pathname.replace(/\/+$/, ""); // 끝 '/' 제거
    document.querySelectorAll(".sidebar a").forEach(a => {
      const href = a.getAttribute("href");
      if (!href) return;
      const clean = href.replace(/\/+$/, "");
      // 정확히 같거나, 현재 경로가 해당 링크로 끝나는 경우 활성화
      if (here === clean || (clean !== "/" && here.endsWith(clean))) {
        a.classList.add("active");
      }
    });
  })();

  // --- Sidebar: 검색 필터 추가 ---
  (function() {
    const input = document.getElementById("nav-filter");
    if (!input) return;

    input.addEventListener("input", (e) => {
      const q = e.target.value.trim().toLowerCase();

      // 링크 텍스트 기준 필터
      const links = document.querySelectorAll(".sidebar nav a");
      links.forEach(a => {
        const show = a.textContent.toLowerCase().includes(q);
        a.style.display = show ? "block" : "none";
      });

      // details 그룹: 내부에 보이는 링크가 있으면 펼치고, 없으면 숨김
      document.querySelectorAll(".sidebar nav details").forEach(d => {
        const anyVisible = Array.from(d.querySelectorAll("a")).some(a => a.style.display !== "none");
        d.open = anyVisible || q !== "";
        d.style.display = anyVisible || q === "" ? "block" : "none";
      });
    });
  })();
    
  </script>
</body>
</html>
